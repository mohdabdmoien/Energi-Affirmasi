<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>Mesin Energi Cikmat</title>
<style>
body {
font-family: Arial, sans-serif;
background: #fff8d1;
padding: 30px;
text-align: center;
}
input, textarea, select, button {
padding: 10px;
margin: 8px;
width: 80%;
max-width: 500px;
border: 1px solid #ccc;
border-radius: 5px;
}
#output {
margin-top: 20px;
background: #fff;
padding: 15px;
border-radius: 8px;
min-height: 80px;
max-width: 700px;
margin: 0 auto;
text-align: left;
}
</style>
</head>
<body>
<h1>🔆 Mesin Energi Cikmat</h1>
<p>Masukkan niat & pancarkan kepada semesta 🌌</p>
<audio id="audioTone" src="tone.mp3" preload="auto"></audio>

<textarea id="intention" placeholder="Contoh: Aku penuh kasih & rezeki melimpah..."></textarea><br>
<select id="frequency">
<option value="3600000">Optimal (1x/Jam)</option>
<option value="128">Schumann (7.83 Hz)</option>
<option value="333">Deep Delta (3 Hz)</option>
<option value="1">Max Frequency</option>
</select><br>
<label><input type="checkbox" id="boost"> Power Boost (SHA‑512)</label><br>
<input type="file" id="fileInput"><br>
<button onclick="startRepeater()">Mula</button>
<button onclick="stopRepeater()">Berhenti</button>
<div id="output"></div>

<script>
let interval, count = 0, startTime;

function showPopup() {
alert("⚡ Energi affirmasi sedang dibina...\nTerima kasih menggunakan Mesin Energi Cikmat!");
}

function saveToServer(data) {
fetch('YOUR_SERVER_ENDPOINT_HERE', {
method: 'POST',
headers: {'Content-Type': 'application/json'},
body: JSON.stringify(data),
})
.then(res => console.log('✅ Affirmasi disimpan'))
.catch(err => console.error('❌ Gagal simpan affirmasi', err));
}

function startRepeater() {
const txt = document.getElementById('intention').value.trim();
const freq = parseInt(document.getElementById('frequency').value);
const boost = document.getElementById('boost').checked;
const file = document.getElementById('fileInput').files[0];
const output = document.getElementById('output');
const audio = document.getElementById('audioTone');

if (!txt) return alert("🎯 Isi dulu kan niat tu!");
showPopup();
audio.play().catch(() => console.log('Audio failed to play'));

const payload = {intention: txt, timestamp: Date.now()};
saveToServer(payload);

output.innerHTML = "";
count = 0;
startTime = Date.now();

if (file) {
const reader = new FileReader();
reader.onload = e => {
const hash = btoa(e.target.result);
runRepeater(`${txt} + FILEHASH(${hash})`, freq, boost);
};
reader.readAsBinaryString(file);
} else {
runRepeater(txt, freq, boost);
}
}

function runRepeater(msg, freq, boost) {
const output = document.getElementById('output');
interval = setInterval(() => {
count++;
let text = boost ? sha512(msg) : msg;
const elapsed = ((Date.now() - startTime)/1000).toFixed(0);
output.innerHTML = `🔁 ${text}<br>Ulangan: ${count} kali<br>Tempoh: ${elapsed}s`;
}, freq);
}

function stopRepeater() {
clearInterval(interval);
document.getElementById('output').innerHTML += "<br>🛑 Pancaran dihentikan.";
}

// SHA‑512 helper
function sha512(str) {
return CryptoJS.SHA512(str).toString();
}

// load CryptoJS
const script = document.createElement('script');
script.src = "https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js";
document.head.appendChild(script);
</script>
</body>
</html>
